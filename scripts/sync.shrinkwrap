#!/usr/bin/env bash
set -e

if test package.json -nt npm-shrinkwrap.json ; then
  printf "> Your 'package.json' has changed. Syncing 'npm-shrinkwrap.json'... "

  npm prune > /dev/null
  npm shrinkwrap --dev > /dev/null
  echo "DONE!"

  diff=$(git diff --name-only npm-shrinkwrap.json)
  if [[ "$diff" != "" ]] ; then
    echo "> Please commit 'npm-shrinkwrap.json' too, as it was updated."
    exit 1
  fi
fi
